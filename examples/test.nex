#NEXUS
begin params; 
[================================================================]
[ LINKING of parameters across partitions ]
[================================================================]
[ notice: everything (except branch lengths) is unlinked by default ]
[ Thus, if you omit partition ids for a certain proposal type, 
  then you have an additional parameter to integrate ]


[ stateFreq = (0,1,2,3)  ]   [ <= 0,1 are linked, we have separate state frequency parameters for 2 and 3 ]
[ rateHet = (0,2,1,3) ] 
[ revMat = (0,1,2,3)  ] 

[ TODO: branch lengths ]
end;  


[================================================================]
[ PRIOR configuration ]
[================================================================]
begin PRIOR; 
[ topology: constraints not enabled currently  ]
[ topoPr fixed()  ] 
[ topoPr uniform(0,1) ]

[ topoPr uniform(0,1)] 

[ branch lengths: TODO per-partition,clock ]
[  brlenpr uniform(0.0000001,4)   ] 
[ brlenpr fixed()  ]      [ you should have provided a user tree with branch lengths ]  
[  brlenpr{3} exponential(10.0) ] 
[ brlenpr exponential(10) ] 

[ substitution matrix ]
[  revMatPr dirichlet(1,2,3,4,5,6)    ] 
[ revMatPr fixed(1,2,3,4,5,6) ] 

[ state frequencies ] 
[  stateFreqPr{0}  dirichlet(2.0,1.0,1.0,1.0)   ] 
[ stateFreqPr fixed(empirical) ] [ NOT implemented yet ] 
[ stateFreqPr fixed(1,2,3,4)   ] 

[ rate heterogeneity: alpha parameter ]
[ shapePr exponential(1) ]
[ shapePr uniform(0.0000001,200) ] 
[ shapePr fixed(1)   ] 

[ todo: prior in substitution matrices ]

end; 

begin runconfig; 
 [ NOTICE: please do not use scientific notation for numbers (e.g., 1e-6). Right now, we cannot parse this ] 

 [ RUN PARAMETERS ]
 diagFreq 5000		[ check for convergence of multiple independent runs after this many generations ]
 samplingFrequency 500 	[ take a sample every n generations ]
 numRuns  1 		[ number of independant runs ]
 numGen 10000             [ if numRuns = 1, stop simulation after that many generations ] 
 tuneFreq 100 		[ tune move parameters every n generations, set to 0, if you want to disable parameter tuning ] 
 printFreq 1000		[ print a sample to the screen every n generations, set to 0 if you want to disable output info about the state of the chains  ]
 
 [ CONVERGENCE ]
 asdsfIgnoreFreq  0.1	[ ignore clades for which the relative  frequency in no chain exceeds this value ]
 asdsfConvergence  0.005    [ indicate convergence, as soon as the asdsf is below this value: 1-5% is considered good, 0.005 can be considered very good convergence ] 


 [ MCMCMC ]
 numCoupledChains 1	   [ number of chains per independent run (only one is cold)  => must be > 0] 
 heatFactor 0.1   	   [ the heat increment added to each hotter chain (this is not the inverse heat)   ]
 swapInterval 1 	   [ attempt a swap between chains every n generations ]
 tuneHeat false        [ if true, the heat increment will be tuned, s.t. the cold chain swaps with the coldest hot chain in 23.45% of all cases   ] 
 
 [ BURNIN ] 
 [ comment out one of the two options ]      
 [ burninGen 2000 ]     [ exact number of generations that are discarded for diagnostics ]  
 burninProportion 0.25 [ discard this proportion of all initial samples as burnin  ]

end; 
 
 
 begin proposals; 
 
 [================================================================]
 [ PROPOSAL configuration ]
 [================================================================]

[
      [ TOPOLOGY ]

      eSPR 0 
      stNNI 0
      eTBR  10
      parsimonySPR 0

      guidedSPR 0
]
 
 
 
      [ BRANCH LENGTHS ] 
[       branchSlider 0 ] [ <===== for enabling this, see the ProposalRegistry ]
      branchMulti 20 
      treeLengthMult 2 
      nodeSlider  5 
      GuidedBL 0 []
      branchCollapser 0 [ bug! ]

      [ RATE HETEROGENEITY ]
[       rateHetSlider 0 ] 
      rateHetMulti 1 

      [ REVMAT ] 
      revMatSlider 0.5
      revMatDirichlet 0.5

      [ FREQUENIES ]
      FrequencySlider 0.5
      FrequencyDirichlet 0.5

      [ AA models ]
[       aaModelJump 0  [ todo ] ] 



      [ PARAMETERS for various moves ]
      guidedSPRRadius 10  [ maximum radius that is searched by the guided spr move ] 
       eSprStopProb 0.5 [ stopping probability for eSPR moves, 0.5 in mb! ] 
      parsimonyWarp 0.10 [ warp factor for parsimony based moves => if we set that to 10, it is a reference to the star trek voyager episode "threshold" ]  


      [================================================================]

end ; 
